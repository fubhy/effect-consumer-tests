{"version":3,"file":"core.js","names":["Cause","require","Context","Effect","Either","Equal","Exit","FiberRef","Function_js_1","Hash","Pipeable_js_1","Predicate_js_1","Stream_js_1","core_stream_js_1","core_js_1","effectable_js_1","effect_js_1","sink_js_1","OpCodes","TExitOpCodes","TryCommitOpCodes","Journal","STMState","TExit","TryCommit","TxnId","STMSymbolKey","exports","STMTypeId","Symbol","for","stmVariance","_R","_","_E","_A","STMPrimitive","i0","_tag","OP_COMMIT","_op","i1","undefined","i2","EffectTypeId","StreamTypeId","SinkTypeId","ChannelTypeId","constructor","effectVariance","symbol","that","random","commit","unsafeAtomically","constVoid","pipe","pipeArguments","arguments","isSTM","u","hasProperty","self","onDone","onInterrupt","withFiberRuntime","state","fiberId","id","env","getFiberRef","currentContext","scheduler","currentScheduler","priority","currentSchedulingPriority","commitResult","tryCommitSync","OP_DONE","exit","OP_SUSPEND","txnId","make","value","running","effect","async","k","tryCommitAsync","uninterruptibleMask","restore","catchAllCause","cause","currentState","isRunning","interrupted","isDone","failCause","tryCommit","stm","journal","Map","tExit","STMDriver","run","analysis","analyzeJournal","JournalAnalysisReadWrite","commitJournal","JournalAnalysisInvalid","Error","OP_SUCCEED","fromTExit","completeTodos","succeed","OP_FAIL","fail","error","OP_DIE","die","defect","OP_INTERRUPT","interrupt","OP_RETRY","suspend","isSuccess","context","result","completeTryCommit","addTodo","todos","collectTodos","size","scheduleTask","execTodos","done","__","contextWith","f","map","contextWithSTM","flatMap","contStack","r0","getEnv","pushStack","cont","push","popStack","pop","nextSuccess","current","OP_ON_SUCCESS","nextFailure","OP_ON_FAILURE","nextRetry","OP_ON_RETRY","curr","unsafeGet","left","NoSuchElementException","right","retry","OP_WITH_STM_RUNTIME","OP_PROVIDE","ensuring","sync","OP_SYNC","e","catchAll","dual","mapInputContext","dieSync","dieMessage","message","RuntimeException","evaluate","withSTMRuntime","finalizer","matchSTM","onFailure","zipRight","onSuccess","a","failSync","either","interruptAs","orTry","zip","zipWith","a1","zipLeft","b"],"sources":["../../../../src/internal/stm/core.ts"],"sourcesContent":[null],"mappings":"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"}